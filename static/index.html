<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>NIDS Dashboard</title>
    <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }
        .section {
            margin-bottom: 30px;
        }
        h2 {
            border-bottom: 1px solid #ccc;
        }
        .alert {
            padding: 10px;
            margin: 5px 0;
            background-color: #f8d7da;
            border: 1px solid #f5c2c7;
        }
        .normal {
            color: green;
        }
        .suspicious {
            color: red;
        }
    </style>
</head>
<body>
    <h1>Network Intrusion Detection System Dashboard</h1>

    <div class="section">
        <h2>Status</h2>
        <p id="status">Loading...</p>
    </div>

    <div class="section">
        <h2>Traffic Data</h2>
        <p><strong>Normal:</strong> <span id="normal-traffic">0</span></p>
        <p><strong>Suspicious:</strong> <span id="suspicious-traffic">0</span></p>
    </div>

    <div class="section">
        <h2>Recent Alerts</h2>
        <div id="alerts"></div>
    </div>

    <script>
        const socket = io();

        socket.on('connect', () => {
            console.log("Connected to server");
        });

        socket.on('status', data => {
            document.getElementById('status').textContent = data.running ? "Running" : "Stopped";
        });

        socket.on('traffic_data', data => {
            let normal = data.normal[data.normal.length - 1] || 0;
            let suspicious = data.suspicious[data.suspicious.length - 1] || 0;
            document.getElementById('normal-traffic').textContent = normal;
            document.getElementById('suspicious-traffic').textContent = suspicious;
        });

        socket.on('alerts', data => {
            updateAlerts(data);
        });

        socket.on('new_alert', alert => {
            addAlert(alert);
        });

        function updateAlerts(alerts) {
            const alertsContainer = document.getElementById('alerts');
            alertsContainer.innerHTML = '';
            alerts.forEach(addAlert);
        }

        function addAlert(alert) {
            const div = document.createElement('div');
            div.className = 'alert';
            div.innerHTML = `<strong>${alert.type}</strong> from ${alert.source} - ${alert.details} <em>at ${alert.time}</em>`;
            const alertsContainer = document.getElementById('alerts');
            alertsContainer.prepend(div);
        }
    </script>
</body>
</html>
     -->

     <!DOCTYPE html>
     <html lang="en">
     <head>
         <meta charset="UTF-8">
         <title>NIDS Dashboard</title>
         <script src="https://cdn.socket.io/4.0.0/socket.io.min.js"></script>
         <style>
             body {
                 font-family: Arial, sans-serif;
                 margin: 20px;
             }
             .section {
                 margin-bottom: 30px;
             }
             h2 {
                 border-bottom: 1px solid #ccc;
             }
             .alert {
                 padding: 10px;
                 margin: 5px 0;
                 background-color: #f8d7da;
                 border: 1px solid #f5c2c7;
             }
             .normal {
                 color: green;
             }
             .suspicious {
                 color: red;
             }
             button {
                 padding: 10px 20px;
                 margin-right: 10px;
                 font-size: 16px;
             }
         </style>
     </head>
     <body>
         <h1>Network Intrusion Detection System Dashboard</h1>
     
         <div class="section">
             <h2>Status</h2>
             <p id="status">Loading...</p>
             <button onclick="startNIDS()">Start</button>
             <button onclick="stopNIDS()">Stop</button>
         </div>
     
         <div class="section">
             <h2>Traffic Data</h2>
             <p><strong>Normal:</strong> <span id="normal-traffic">0</span></p>
             <p><strong>Suspicious:</strong> <span id="suspicious-traffic">0</span></p>
         </div>
     
         <div class="section">
             <h2>Recent Alerts</h2>
             <div id="alerts"></div>
         </div>
     
         <script>
             const socket = io();
     
             socket.on('connect', () => {
                 console.log("Connected to server");
             });
     
             socket.on('status', data => {
                 document.getElementById('status').textContent = data.running ? "Running" : "Stopped";
             });
     
             socket.on('traffic_data', data => {
                 let normal = data.normal[data.normal.length - 1] || 0;
                 let suspicious = data.suspicious[data.suspicious.length - 1] || 0;
                 document.getElementById('normal-traffic').textContent = normal;
                 document.getElementById('suspicious-traffic').textContent = suspicious;
             });
     
             socket.on('alerts', data => {
                 updateAlerts(data);
             });
     
             socket.on('new_alert', alert => {
                 addAlert(alert);
             });
     
             function updateAlerts(alerts) {
                 const alertsContainer = document.getElementById('alerts');
                 alertsContainer.innerHTML = '';
                 alerts.forEach(addAlert);
             }
     
             function addAlert(alert) {
                 const div = document.createElement('div');
                 div.className = 'alert';
                 div.innerHTML = `<strong>${alert.type}</strong> from ${alert.source} - ${alert.details} <em>at ${alert.time}</em>`;
                 const alertsContainer = document.getElementById('alerts');
                 alertsContainer.prepend(div);
             }
     
             function startNIDS() {
                 fetch('/api/start', { method: 'POST' })
                     .then(res => res.json())
                     .then(data => {
                         if (data.success) {
                             alert("NIDS started successfully");
                         } else {
                             alert("Failed to start NIDS");
                         }
                     });
             }
     
             function stopNIDS() {
                 fetch('/api/stop', { method: 'POST' })
                     .then(res => res.json())
                     .then(data => {
                         if (data.success) {
                             alert("NIDS stopped successfully");
                         } else {
                             alert("Failed to stop NIDS");
                         }
                     });
             }
         </script>
     </body>
     </html>
     